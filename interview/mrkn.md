---
layout: page
title: 村田賢太さんインタビュー
permalink: /interview/mrkn/
---

{% include interview-head github='mrkn' %}

5/17 Ruby 開発会議をやっている裏でチャットで伺いました（話し手：村田さん、聞き手：笹田）。

## IMF gem

__笹田__ 今回のご発表は、[IMF](https://github.com/mrkn/IMF) という、画像操作ライブラリを作ったので、そのご紹介ということですね。

__村田__ はい、その通りです。

__笹田__ RMagick の代替 (同じようなことをやる)、ということでしょうか

__村田__ 僕がやりたかったことが RMagick ではできなかった (と思う) ので、その時に ImageMagick とは関わりたくないなと思って、作ることにしました。

__笹田__ IMF は、ImageMagick と比べて、できることは多いのでしょうか。

__村田__ IMF単体では多くはなりません。ただ、将来的には多くなるような構想があります。

__笹田__ ImageMagick にない、やりたかったことというのは何でしょうか。

__村田__ 画像を開いて、テンソルとして扱いたかったんですね。画像ってベクトル場なんですよ。

__笹田__ なるほどわからん。数値計算で扱うようにデコードしたかった、というイメージですかね？

__村田__ そういうことですね。で、そのテンソルを NArray や NMatrix のような行列計算ライブラリでいじったり、OpenCV に渡したり、GSL の関数に渡したり、TensorFlow とか MXNet で作ったニューラルネットワークに渡したりできたら楽しいだろうなと思ったわけですよ。

__笹田__ なるほど。

__村田__ RMagick では、そういうのには対応していないと思いますから、やるとしたら RMagick にパッチを送る必要がありました。でも、それはやらなかった。

__笹田__ RMagick も、中ではそれを取り出してるんだろうけど、それを Ruby レベルでは取り出せなかったんですね。

__村田__ そうですね

__笹田__ なんで patch にしなかったんでしょうか。

__村田__ 二つ理由があって、一つはさっき言ったように ImageMagick に強く関係するのはちょっと嫌だなぁと思ったことですね。ImageMagick 自体が大きいですよね、依存関係などを含めると。なので、自分がやりたいことのために ImageMagick が必須になってしまうのは嫌でした。

__笹田__ なるほど。もう一つは？

__村田__ もう一つの理由としては、Ruby の `IO` っぽいオブジェクトから画像を読んだり、画像を書き込んだりできると便利だろうなと思って、それを実現したかったというのもありますね。例えば、IMF は今すでに `Zlib::GzipReader` から画像を読み込めるんで、便利かどうかは別として Ruby のためのライブラリっぽくはなってます。

__笹田__ なるほど。

__村田__ IMF 本体は、今のところ JPEG と PNG に対応していて、東京 Ruby 会議 11 までに WebP にも対応できたら嬉しいなと思って準備を進めているんですが、ファイルフォーマットの読み書きをプラグインで作れるようにしてるので、僕じゃなくても作れるようになってます。

__笹田__ IMF 自体は、読み込みで終わり？

__村田__ IMF 自体は読み書き、変形、簡単なフィルタリング、空の画像を作って何か描いたりとかできるようにはしたいですね。

__笹田__ 発表では、これの作り方になる？　それとも、使った応用の話ですかね

__村田__ 発表では、このライブラリの目指している位置付けを説明して、一人ではなかなか開発が進まないので協力者を募集しようと思ってます。発表のメインは、この画像ライブラリの中身よりも、むしろ位置付けの部分ですね。

__笹田__ 応用例をご紹介は頂けるでしょうか。

__村田__ 応用例として、そのテンソルデータを他のライブラリとやりとりするための道具も紹介するので、そっちをむしろメインにしたほうが良いかなと今は考えていますね。

__笹田__ 実際の問題を解いた、みたいな例はどうでしょうか。見た目わかりやすいやつ。

__村田__ ディープラーニング！とかできたら楽しそうですね。

__笹田__ 「Python につなぎます」

__村田__ 実は julia っていう gem も (今は開発が止まってるんですが) 作っていて、Julia と繋ぐやつをもっとちゃんと作りたいなとは思ってますね。Python より良いと思いますよ。

__笹田__ 実際の発表ではできそう？

__村田__ julia ではないですが、もうちょっとタイムリーな応用例は出すつもりです。

__笹田__ 楽しみですね！

__村田__ 僕は画像ライブラリは、画像を読み書きするところだけちゃんとやっておけば良いと思っていて、画像を加工する部分は他のライブラリに任せられるようになってる方が良いと思うんですよね。なので、IMF はそういう方向で設計と開発を進めて、それと一緒に使うための道具も準備しようという内容の発表になる予定です。

__笹田__ 発表は、こういう応用の世界の広がり、夢広がり、ってやつになるわけですね。

__村田__ はい、そうです。

__笹田__ コード例とかどこかで見ることはできるでしょうか。

__村田__ 例えば、[https://github.com/mrkn/IMF/blob/image_format/spec/IMF/image/open_spec.rb#L104-L135](https://github.com/mrkn/IMF/blob/image_format/spec/IMF/image/open_spec.rb#L104-L135)
 がテストになります。使い方などは、[GitHub のリポジトリ](https://github.com/mrkn/IMF/)に追々整備していきます。ちなみに、一通り開発が進んだら SciRuby organization に移管しようと思ってます。

## SciRuby-jp コミュニティ

__笹田__ こういう応用を Ruby から使いたい、というと、どの辺をチェックすればいいでしょう。

__村田__ 最近 [SciRuby-jp という Google Group](https://groups.google.com/forum/#!forum/sciruby-jp) を作りました。これは、日本で活動する Rubyists のために日本語と英語で統計や機械学習や科学技術計算について議論できるものです。

__笹田__ ふむふむ。

__村田__ これまで [SciRuby Development group という Google Group](https://groups.google.com/forum/#!forum/sciruby-dev) が世界の Rubyist のために開かれたグループだったんですが、日本語では議論がしづらいでしょうし、日本で開かれるイベントの情報を投稿するのもやりにくいので、日本という地域向けにと思って用意しました。ここに、SciRuby 本家の動きを日本語で展開したりもしていこうと思っているので、こういう分野に興味ある人、特に統計や機械学習を Ruby でやってる人の参加をお待ちしてます。

__笹田__ なるほど。ありがとうございました。発表楽しみにしています。
