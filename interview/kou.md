---
layout: page
title: 須藤功平さんインタビュー
permalink: /interview/kou/
---

{% include interview-head github='kou' %}

5/9 クリアコードにて伺いました（話し手：須藤さん、聞き手：笹田）。

__笹田__ お忙しい中、ありがとうございます。今回の話は Groonga と milter manager に Ruby を組み込む、という話だと思うのですが、Groonga については、RubyKaigi 2014 の、『[Three Ruby usages](http://slide.rabbit-shocker.org/authors/kou/rubykaigi-2014/)』でご発表されていましたよね。

__須藤__ 今回は30分しか時間がないので、milter manager の話だけにしようかと思います。

__笹田__ milter manager というのは、メールのフィルタのマネージャ？

![ブロックダイアグラム]({{ site.url }}/image/kou-milter-manager.jpg){:width="80%"}
{: style="text-align: center;"}

__須藤__ こんな感じで、いくつか独立してフィルタが動作している状態だったものを、メタフィルタのようなレイヤを導入して、それらの独立したフィルタをうまいこと協調させて、効率的にフィルタを動作させる、というものです。

__笹田__ それらの独立したフィルタは、すでにあって、それらをまとめる、ということでしょうか。

__須藤__ そうです。これがないと、すべてのメールに対してすべてのフィルタを実行しなければならなかったのですが、あるフィルタの結果を受けて別のフィルタを止めるとか、複数のフィルタで共通の条件をメタフィルタのレイヤでまとめて適用する、といったように柔軟に設定できるようになります。

__笹田__ 便利そうですね。よく売れてるんですか？

__須藤__ milter manager自体は無料でだれでも自由に使える状態で公開しているので売れてはいないです。導入支援やサポートを提供しているんですがそれらは売れています。また、フィルタの開発も請け負っています。フィルタの適用条件を Ruby で柔軟に書けるので、それを使ってプロバイダの方が利用されたりしています。

__笹田__ この milter manager は C で構築してあるんでしょうか。

__須藤__ はい、性能が欲しかったので。設定は Ruby で書きたかったので、Ruby を埋め込みました。

__笹田__ Ruby で作って、C で性能が必要になる部分を作る、という選択肢（性能が必要になる部分をCで作ってRubyの拡張ライブラリにしてRubyから使うという選択肢）もあったと思うのですが。

__須藤__ 基本的には同じなんですが、C でコアを作っておくと、（CやPythonなど）他の言語から使える、という利点があります。それを狙っていました。しかし、誰も他の言語から使っていないようなので、今思えば、Ruby で作っても良かったかもしれません。

__笹田__ コアを C で書くと、Ruby に問題があれば、最悪外してしまうという選択肢もとれるかもしれませんね。

__須藤__ まぁ、Ruby を切る気はありませんが。全部Rubyで実装した場合には、ボトルネックはネットワークまわりとプロトコルのパースになったと思います。今回の発表では、こういう、C で作成したアプリケーションに CRuby をどう埋め込むか、その事例の話をしたいと思います。そういう話に興味がある方は、ぜひ聞いて貰えればと思います。

（細かい実装の話もしましたが、省略）

# OSS Gate

__笹田__ 今回、東京Ruby会議11では、OSS Gate という会を同じ会場で開催する予定です（詳しくは：[OSS Gateワークショップ2016-05-28](https://oss-gate.doorkeeper.jp/events/38550)）。須藤さんが始められた、学生さんに OSS の入り口を紹介する、という勉強会、でいいでしょうか。

__須藤__ ちょっと違って、学生に限らず、誰でも OSS が興味がある方に来て貰いたいと思っています。OSS に不満があるような方が、実際に行動して改良できるようになってもらえるといいな、と思っています。あと、勉強会というスタイルではなくてワークショップというスタイルでやっています。実際に手を動かした方がいいので。

__笹田__ なるほど。

__須藤__ 東京Ruby会議11 の話題は、OSS に関する技術的な話がメインですよね。その発表の内容は OSS に関することなので、実装を簡単に確認できたり、勉強したりできます。さらによくするために開発に参加することもできます。ただ、OSSの開発に参加したことがない人にはそれらの敷居が高いと思うので、その敷居を下げるお手伝いができればと思っています。

__笹田__ いいですね。

__須藤__ 実装を見ることができるというのは、とてもいいと思うんですよね。話を聞いているだけ、だともったいない。ソースがあるんだから、もっと活用してもらいたいですね。発表で喋っていた内容を、実際に動かしてみると動かない、ってこともありますし。

__笹田__ あるある。

__須藤__ そんなときにバグレポートしたり直したりすると、スピーカーと参加者がますます交流できると思いますし。

__笹田__ OSS Gateは、東京Ruby会議11と併催しているので、須藤さんに声をかけてもらえれば、OSS Gateの見学ができる、ということですね。

__須藤__ はい。声を掛けてもらえればと思います。[OSS Gateのサイトにも説明がある](http://oss-gate.github.io/announce/update/2015/12/17/welcome-to-oss-gate.html)ので興味がある人はそっちも読んでみて欲しいです。

__笹田__ よろしくお願いします。今日は、お忙しいところ、ありがとうございました。
